[[runs]]
expr = '''
NB. Diamond Kata

NB.    dia 'ABCD'
NB. ---A---
NB. --B-B--
NB. -C---C-
NB. D-----D
NB. -C---C-
NB. --B-B--
NB. ---A---

dia =: {{ (] ,"1 }.@|."1) ([ , }.@|.) (>:i. #y) |."0 1 (,. ,"1 (<:@# # '-'&[)) y}}

dia 'ABCD'
'''
output = '''
---A---
--B-B--
-C---C-
D-----D
-C---C-
--B-B--
---A---
'''
encoded = 'e3,02,31,02,07,07,2d2d2d412d2d2d2d,2d422d422d2d2d43,2d2d2d432d442d2d,2d2d2d442d432d2d,2d432d2d2d422d42,2d2d2d2d2d412d2d,2d'

[[runs]]
expr = '''
NB. should be pulled in from stdlib.ijs
split =: ({. ,&< }.)
LF =: 10{a.
s3 =: 0 : 0
vJrwpWtwJgWrhcsFMMfFFhFp
jqHRNqRjqzjGDLGLrsFMfFZSrLrFZsSL
PmmdzqPrVvPwwTWBwg
wMqvLMZHhHMvwLHjbvcjnnSBnvTQFn
ttgJtRGJQctTZtZT
CrZsJsPPZsGzwwsLwLmpwMDw
)
s3 =: (LF=s3) < ;._2 s3

rucksacks =: (-:@# split ]) &> s3
dups =: ([: ([: ~. e./ # {.) [: > -:@# split ]) &> s3
alphabet =: a. {~ (96+i.27),(65+i.26)

d3p1=: +/ alphabet i. dups

NB. day 3 part 2

groups =: _3 ]\ s3

badge =: {{
's1 s2 s3'=. y
~. s1 #~ (s1 e. s2) *. (s1 e. s3)
}}

badges =: badge"1 groups

d3p2 =: +/ alphabet i. badges

d3p1; d3p2
'''
output = '''
┌───┬──┐
│157│70│
└───┴──┘
'''
encoded = '''
e3,2,02,01,02,38,68,
e3,04,01,01,01,9d,
e3,04,01,01,01,46'''

[[runs]]
expr = '''
a =: (<'hello')
(>a) =: (0 2 $ 0)
a
'''
output = '''
┌─────┐
│hello│
└─────┘
'''
encoded = '''
e3,2,01,,28,
e3,02,05,01,05,68656c6c6f'''

[[runs]]
expr = '''
a =: {{
b =: 6
x + b
}}
5 a 7
'''
output = '''
11
'''
encoded = 'e3,04,01,,0b'

[[runs]]
expr = '''
a =: {{)d
  if. x > y do.
    b =: x
  else.
    b =: y
  end.
  b * 2
}}
(6 a 5); (4 a 3)
'''
output = '''
┌──┬─┐
│12│8│
└──┴─┘
'''
encoded = '''
e3,2,02,01,02,38,6,
e3,04,01,,0c,
e3,04,01,,08'''

[[runs]]
expr = '''
a =: {{)m
  r =. 5
  if. y > 3 do.
    r =. 7
  end.
  r
}}

(a 4); (a 2)
'''
output = '''
┌─┬─┐
│7│5│
└─┴─┘
'''
encoded = '''
e3,2,02,01,02,38,6,
e3,04,01,,07,
e3,04,01,,05'''

[[runs]]
expr = '''
a =: {{)m
  r =. 9
  if. y > 3 do.
    r =. 7
  elseif. y > 1 do.
    r =. 6
  else.
    r =. 5
  end.
  r
}}

(a 4); (a 2); (a 0)
'''
output = '''
┌─┬─┬─┐
│7│6│5│
└─┴─┴─┘
'''
encoded = '''
e3,2,03,01,03,4,68,9,
e3,04,01,,07,
e3,04,01,,06,
e3,04,01,,05'''

[[runs]]
expr = '''
a =: {{)m
g1 =: 1
l1 =. 2
'g2 g3' =: 3 4
'l2 l3' =. 5 6
'g4' =: 8
'l4' =. 8
g1; g2; g3; g4; l1; l2; l3; l4
}}
a ''
'''
output = '''
┌─┬─┬─┬─┬─┬─┬─┬─┐
│1│3│4│8│2│5│6│8│
└─┴─┴─┴─┴─┴─┴─┴─┘
'''
encoded = '''
e3,2,08,01,08,68,9,b8,e,0801,3001,5801,8001,
e3,01,01,,01,
e3,04,01,,03,
e3,04,01,,04,
e3,04,01,,08,
e3,04,01,,02,
e3,04,01,,05,
e3,04,01,,06,
e3,04,01,,08'''

[[runs]]
expr = '''
a=: <;._2 ] 'Try and try and try again '
(~. a); (=a); (= <'and')
'''
output = '''
┌───────────────────┬───────────┬─┐
│┌───┬───┬───┬─────┐│1 0 0 0 0 0│1│
││Try│and│try│again││0 1 0 1 0 0│ │
│└───┴───┴───┴─────┘│0 0 1 0 1 0│ │
│                   │0 0 0 0 0 1│ │
└───────────────────┴───────────┴─┘
'''
encoded = '''
e3,2,03,01,03,4,4801,9801,
e3,2,04,01,04,48,78,a8,d8,
e3,02,03,01,03,547279,
e3,02,03,01,03,616e64,
e3,02,03,01,03,747279,
e3,02,05,01,05,616761696e,
e3,01,18,02,04,06,0100000000000001,00010000000001,0100000000000001,,
e3,01,01,02,01,01,01'''

[[runs]]
expr = '''
f =: {{)m
  a =: 0
  try.
    a =: 6
  catch. end.
}} ''

a
'''
output = '''
6
'''
encoded = 'e3,04,01,,06'

[[runs]]
expr = '''
foo =: 5
del =: 4!:55 <'foo'
missing =: 4!:55 <'quux'
status =: 4!:0 <'foo'
status; del; missing
'''
output = '''
┌──┬─┬─┐
│_1│1│1│
└──┴─┴─┘
'''
encoded = '''
e3,2,03,01,03,4,68,9,
e3,04,01,,ffffffffffffffff,
e3,01,01,,01,
e3,01,01,,01'''

[[runs]]
expr = '''
n1 =: 5
n2 =: 'potato'
v1 =: +
a1 =: &.>
c1 =: :
l1 =. 7

(4!:0)"0 ('n1'; 'n2'; 'v1'; 'a1'; 'c1'; 'm1'; 'l1')
'''
output = '''
0 0 3 1 2 _1 0
'''
encoded = 'e3,04,07,01,07,,,03,01,02,ffffffffffffffff,'

[[runs]]
expr = '''
queens=: 3 : 0
 z=.i.n,*n=.y
 for. }.z do.
  b=. -. (i.n) e."1 ,. z +"1 _ ((-i.){:$z) */ _1 0 1
  z=. ((+/"1 b)#z),.n|I.,b
 end.
)

(queens 4); (queens 5)
'''
output = '''
┌───────┬─────────┐
│1 3 0 2│0 2 4 1 3│
│2 0 3 1│0 3 1 4 2│
│       │1 3 0 2 4│
│       │1 4 2 0 3│
│       │2 0 3 1 4│
│       │2 4 1 3 0│
│       │3 0 2 4 1│
│       │3 1 4 2 0│
│       │4 1 3 0 2│
│       │4 2 0 3 1│
└───────┴─────────┘
'''
encoded = '''
e3,2,02,01,02,38,a8,
e3,04,08,02,02,04,01,03,,02,02,,03,01,
e3,04,32,02,0a,05,,02,04,01,03,,03,01,04,02,01,03,,02,04,01,04,02,,03,02,,03,01,04,02,04,01,03,,03,,02,04,01,03,01,04,02,,04,01,03,,02,04,02,,03,01'''

[[runs]]
expr = '''
s =: ((3 : 0) 5)
y + 7
)

s
'''
output = '''
12
'''
encoded = 'e3,04,01,,0c'

[[runs]]
expr = '''
s =: 0 : 0
1
2

3
4
)
s
'''
output = '''
1
2

3
4

'''
encoded = 'e3,02,09,01,09,310a320a0a330a34,0a'

[[runs]]
expr = '''
s =: 0 : 0
hello world
I love horses
)
s
'''
output = '''
hello world
I love horses

'''
encoded = 'e3,02,1a,01,1a,68656c6c6f20776f,726c640a49206c6f,766520686f727365,730a'

[[runs]]
expr = '''
s =: 0 : 0
nznrnfrfntjfmvfwmzdfjlvtqnbhcprsg
)

parse =: <
general =: [: ; {{ x + 1 i.~ (x = [: #@:~. x {. ])\. y }} &.>
a =: 4 general ]
b =: 14 general ]
(a parse s); (b parse s)
'''
output = '''
┌──┬──┐
│10│29│
└──┴──┘
'''
encoded = '''
e3,2,02,01,02,38,68,
e3,04,01,01,01,0a,
e3,04,01,01,01,1d'''

[[runs]]
expr = '''
s =: 4 : 0
x + y
)

3 s 5

'''
output = '''
8
'''
encoded = 'e3,04,01,,08'

[[runs]]
expr = '''
s =: 5
s
'''
output = '''
5
'''
encoded = 'e3,04,01,,05'

[[runs]]
expr = '''
s6 =: 0 : 0
mjqjpqmgbljsphdztnvjfqwrcgsmlb
)

d6p1 =: (4 + 4 i.~ 4 #@~.\ ]) s6

d6p2 =: (14 + 14 i.~ 14 #@~.\ ]) s6

d6p1; d6p2
'''
output = '''
┌─┬──┐
│7│19│
└─┴──┘
'''
encoded = '''
e3,2,02,01,02,38,6,
e3,04,01,,07,
e3,04,01,,13'''

[[runs]]
expr = '''
t_orig =: 7
18!:4 <'z'
t_zee =: 8
inside =: 't_' (4!:1) 0
18!:4 <'base'
t_after =: 9

inside; ('t_' (4!:1) 0); t_orig; t_zee
'''
output = '''
┌───────┬────────────────┬─┬─┐
│┌─────┐│┌───────┬──────┐│7│8│
││t_zee│││t_after│t_orig││ │ │
│└─────┘│└───────┴──────┘│ │ │
└───────┴────────────────┴─┴─┘
'''
encoded = '''
e3,2,04,01,04,48,a8,4001,6801,
e3,2,01,01,01,3,
e3,02,05,01,05,745f7a6565,
e3,2,02,01,02,38,68,
e3,02,07,01,07,745f6166746572,
e3,02,06,01,06,745f6f726967,
e3,04,01,,07,
e3,04,01,,08'''

[[runs]]
expr = '''
t_orig =: 7
inside =: {{)m
  18!:4 <'z'
  t_zee =: 8
  't_' (4!:1) 0
}} ''
t_zoo =: 9
secondary =: 't_' (4!:1) 0
18!:4 <'base'
t_after =: 10

inside; secondary; ('t_' (4!:1) 0); t_orig; t_zee
'''
output = '''
┌───────┬─────────────┬────────────────┬─┬─┐
│┌─────┐│┌─────┬─────┐│┌───────┬──────┐│7│8│
││t_zee│││t_zee│t_zoo│││t_after│t_orig││ │ │
│└─────┘│└─────┴─────┘│└───────┴──────┘│ │ │
└───────┴─────────────┴────────────────┴─┴─┘
'''
encoded = '''
e3,2,05,01,05,5,b,4801,e001,0802,
e3,2,01,01,01,3,
e3,02,05,01,05,745f7a6565,
e3,2,02,01,02,38,68,
e3,02,05,01,05,745f7a6565,
e3,02,05,01,05,745f7a6f6f,
e3,2,02,01,02,38,68,
e3,02,07,01,07,745f6166746572,
e3,02,06,01,06,745f6f726967,
e3,04,01,,07,
e3,04,01,,08'''

[[runs]]
expr = '''
udc =: 2 : 0
if. n=1 do. u&+
elseif. n=_1 do. u&%
elseif. n= 2 do. u&|
elseif. 1 do. u&-
end.
)

((12 udc 1) 5); ((12 udc 2) 5); ((12 udc _1) 5); ((12 udc 3) 5)
'''
output = '''
┌──┬─┬───┬─┐
│17│5│2.4│7│
└──┴─┴───┴─┘
'''
encoded = '''
e3,2,04,01,04,48,7,98,c,
e3,04,01,,11,
e3,04,01,,05,
e3,08,01,,333333333333034,
e3,04,01,,07'''

[[runs]]
expr = '''
y=: 3 3 $ 'abcdef'
y ; (~.y) ; (=y)
'''
output = '''
┌───┬───┬─────┐
│abc│abc│1 0 1│
│def│def│0 1 0│
│abc│   │     │
└───┴───┴─────┘
'''
encoded = '''
e3,2,03,01,03,4,8,b8,
e3,02,09,02,03,03,6162636465666162,63,
e3,02,06,02,02,03,616263646566,
e3,01,06,02,02,03,0100010001'''
